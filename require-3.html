<html>
    <head>
        <title>CM JS dev, requirement 8</title>

        <script src="bower_components/webcomponentsjs/webcomponents-lite.js"></script>

        <!-- <link href="css/bootstrap.min.css" rel="stylesheet" media="screen"> -->
        <link rel="import" href="bower_components/paper-spinner/paper-spinner.html">
        <link rel="import" href="bower_components/paper-button/paper-button.html">
        <link rel="import" href="bower_components/iron-ajax/iron-ajax.html">
        <link rel="import" href="bower_components/paper-styles/color.html">
    </head>
    <body>

        <dom-module id="issues-app">
            <template>
                <div class="container" style="padding-top:30px">
                    <div>
                        <!-- <input type="button" onclick="startLoading" />
                        <paper-button raised on-tap="toggleLoading">Load the current issues list</paper-button> -->
                        <!-- <template is="dom-if" if={{!isLoading}}> -->
                        <paper-button raised on-tap="toggleLoading">Load the current issues list</paper-button>
                        <template is="dom-if" if="{{isLoading}}">
                            <paper-spinner id="loadingIcon" active alt="Loading...">hello</paper-spinner>
                        </template>
                        <!-- </template> -->
                    </div>
                    
                    <iron-ajax
                         auto
                         url="test.json"
                         handle-as="json"
                         on-request="handleRequest"
                         on-response="handleResponse"
                         on-error="onError"
                         last-response="{{response}}">
                     </iron-ajax>

                    <div id="results">
                        <!-- <dom-module id="result-rows"> -->
                            <template is="dom-repeat" items="{{response}}">
                                <div>ID: {{item.id}}</div>
                                <div>Title: {{item.title}}</div>
                                <div>Description: {{item.description}}</div>
                                <div>Status: {{item.status}}</div>
                                <div>{{item.updates.length}} updates</div>
                            </template>
                            <!-- <script type="text/javascript">
                                Polymer({
                                    is: 'result-rows'
                                });
                            </script> -->
                        <!-- </dom-module> -->
                        <!-- <result-rows></result-rows> -->
                    </div>

                    <div id="results-template" style="display:none">
                        <!-- Each issue should be rendered with the following template -->
                        <div class="issue-template">
                            <h3>Issue Title - Begin 10 minutes ago</h3> <!-- If status === Unresolved -->
                            <h3>Issue Title - Resolved 10 minutes ago</h3> <!-- If status === Resolved -->
                            <p>Issue description</p>
                            <div style="padding-left:50px">
                                <p>Updates:</p>
                                <!-- Each update should be rendered with the following template -->
                                <div class="update-template">                    
                                    <p>Update</p>
                                    <em>By Mat 10 minutes ago</em>
                                    <hr style="width:50%"/>
                                </div>
                            </div>
                            <hr />
                        </div>
                        <!-- Render this if there are no issues returned -->
                        <div class="no-issues-template">
                            Everybody is happy!
                        </div>
                    </div>
                </div>
            </template>

            <script type="text/javascript">
                Polymer({
                    is: 'issues-app',

                    isLoading: false,

                    ready: function() {
                        this.isLoading = false;
                    },

                    toggleLoading: function(event) {
                        this.isLoading = !this.isLoading;
                    }
                });
            </script>
        </dom-module>

        <issues-app></issues-app>

        
    </body>
</html>